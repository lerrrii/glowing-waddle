services:
  jackett-vpn:
    image: dyonr/jackettvpn:latest
    container_name: jackett-vpn
    privileged: true
    cap_add:
      - NET_ADMIN
    devices:
      - /dev/net/tun
    dns:
      - ${NAME_SERVERS}
    environment:
      - VPN_ENABLED=${VPN_ENABLED-yes}
      - VPN_TYPE=${VPN_TYPE-openvpn}
      - VPN_USERNAME=${VPN_USERNAME}
      - VPN_PASSWORD=${VPN_PASSWORD}
      - WEBUI_PASSWORD=${WEBUI_PASSWORD}
      - LAN_NETWORK=${LAN_NETWORK}
      - NAME_SERVERS=${NAME_SERVERS-1.1.1.1,1.0.0.1}
      - PUID=${PUID-1000}
      - PGID=${PGID-1000}
      - UMASK=${UMASK-002}
      - WEBUI_PORT=${WEBUI_PORT-9117}
      - HEALTH_CHECK_HOST=${HEALTH_CHECK_HOST-1.1.1.1}
      - HEALTH_CHECK_INTERVAL=${HEALTH_CHECK_INTERVAL-300}
      - HEALTH_CHECK_SILENT=${HEALTH_CHECK_SILENT-1}
      - ADDITIONAL_PORTS=${ADDITIONAL_PORTS}
    volumes:
      - ${APP_DATA_DIR}/config:/config
      - ${ROOT_FOLDER_HOST}/blackhole:/blackhole
    ports:
      - "${APP_PORT}:9117"
    restart: unless-stopped
    networks:
      - tipi_main_network
    labels:
      traefik.enable: true
      traefik.http.routers.jackett.rule: Host(`${APP_DOMAIN}`)
      traefik.http.services.jackett.loadbalancer.server.port: 9117
      runtipi.managed: true

networks:
  tipi_main_network:
    external: true
